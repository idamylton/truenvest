$(document).ready(function(){$.validator.addMethod("cpf",function(e,a){for(e=$.trim(e),e=e.replace(".",""),e=e.replace(".",""),cpf=e.replace("-","");cpf.length<11;)cpf="0"+cpf;var o=[],r=new Number,t=11;for(i=0;i<11;i++)o[i]=cpf.charAt(i),i<9&&(r+=o[i]*--t);for((x=r%11)<2?o[9]=0:o[9]=11-x,r=0,t=11,y=0;y<10;y++)r+=o[y]*t--;return(x=r%11)<2?o[10]=0:o[10]=11-x,cpf.charAt(9)!=o[9]||cpf.charAt(10)!=o[10]||cpf.match(/^0+$|^1+$|^2+$|^3+$|^4+$|^5+$|^6+$|^7+$|^8+$|^9+$/)?this.optional(a)||!1:this.optional(a)||!0},"Informe um CPF válido."),$.validator.addMethod("dateBR",function(e,a){if(10!=e.length)return this.optional(a)||!1;var o=e,r=o.substr(0,2),i=o.substr(2,1),t=o.substr(3,2),n=o.substr(5,1),d=o.substr(6,4);return 10!=o.length||"/"!=i||"/"!=n||isNaN(r)||isNaN(t)||isNaN(d)||r>31||t>12?this.optional(a)||!1:4!=t&&6!=t&&9!=t&&11!=t||31!=r?2==t&&(r>29||29==r&&d%4!=0)?this.optional(a)||!1:d<1900?this.optional(a)||!1:this.optional(a)||!0:this.optional(a)||!1},"Informe uma data válida"),$.validator.addMethod("datetimeBR",function(e,a){if(16!=e.length)return this.optional(a)||!1;if(" "!=e.substr(10,1))return this.optional(a)||!1;var o=e.split(" ");if(2!=o.length)return this.optional(a)||!1;var r=o[0],i=r.substr(0,2),t=r.substr(2,1),n=r.substr(3,2),d=r.substr(5,1),c=r.substr(6,4);if(10!=r.length||"/"!=t||"/"!=d||isNaN(i)||isNaN(n)||isNaN(c)||i>31||n>12)return this.optional(a)||!1;if((4==n||6==n||9==n||11==n)&&31==i)return this.optional(a)||!1;if(2==n&&(i>29||29==i&&c%4!=0))return this.optional(a)||!1;var s=o[1],l=s.substr(0,2),u=s.substr(2,1),m=s.substr(3,2);return 5!=s.length||isNaN(l)||isNaN(m)||l>23||m>59||":"!=u?this.optional(a)||!1:this.optional(a)||!0},"Informe uma data e uma hora válida"),$.validator.addMethod("timerbr",function(e,a){if(8!=e.length)return!1;var o=e,r=o.substr(0,2),i=o.substr(2,1),t=o.substr(3,2),n=o.substr(5,1),d=o.substr(6,2);return!(8!=o.length||":"!=i||":"!=n||isNaN(r)||isNaN(t)||isNaN(d))&&(r>=0&&r<=23&&t>=0&&t<=59&&d>=0&&d<=59)},"Por favor, um telefone válido"),$.validator.addMethod("notequal",function(e,a,o){return this.optional(a)||e!=$(o).val()},"Este valor não pode ser igual"),$.validator.addMethod("telefone",function(e,a){return e=e.replace("(",""),e=e.replace(")",""),e=e.replace("-",""),this.optional(a)||/[0-9]{10}/.test(e)},"Por favor, um telefone válido"),$.validator.addMethod("celular",function(e,a){return e=e.replace("(",""),e=e.replace(")",""),e=e.replace("-",""),e=e.replace("_",""),e=e.replace(" ",""),this.optional(a)||/[0-9]{10}/.test(e)||/[0-9]{11}/.test(e)},"Informe um celular válido."),$.validator.addMethod("cep",function(e,a){return this.optional(a)||/^\d{5}-\d{3}?$/.test(e)},"Informe um CEP válido.");var e=$("#form_cadastro");e.validate({rules:{cad_nome:"required",cad_mae:"required",cad_nascimento:"required",cad_rg:"required",cad_estadocivil:"required",cad_escolaridade:"required",cad_profissao:"required",cad_email:{required:!0,email:!0},cad_email2:{required:!0,email:!0,equalTo:"#cad_email"},cad_cpf:{required:!0,cpf:!0},cad_telefone1:"required",cad_cep:{required:!0,minlength:9},cad_endereco:"required",cad_numero:"required",cad_bairro:"required",cad_cidade:"required",cad_uf:"required",termo1:"required",termo2:"required"},messages:{cad_nome:"Por favor informe o seu nome completo.",cad_mae:"Por favor informe o nome completo da sua mãe.",cad_nascimento:"Por favor informe a sua data de nascimento.",cad_rg:"Por favor informe a seu RG.",cad_estadocivil:"Por favor selecione o seu estado civil.",cad_escolaridade:"Por favor selecione o seu grau de escolaridade.",cad_profissao:"Por favor informe sua profissão.",cad_email:{required:"Por favor informe seu e-mail.",email:"Por favor informe um e-mail válido"},cad_email2:{required:"Por favor informe novamente seu e-mail.",email:"Por favor informe um e-mail válido",equalTo:"O e-mail não confere."},cad_cpf:{required:"Por favor informe o seu CPF.",cpf:"Por favor informe um CPF válido."},cad_telefone1:"Por favor informe um telefone para contato.",cad_cep:{required:"Por favor informe o CEP da sua residência.",minlength:"CEP inválido."},cad_endereco:"Por favor informe o seu endereço.",cad_numero:"Por favor informe o nº da sua residência.",cad_bairro:"Por favor informe o seu bairro.",cad_cidade:"Por favor informe a sua cidade.",cad_uf:"Por favor informe o seu estado.",termo1:"Por favor confirme a declaração de veracidade das informações.",termo2:"Por favor confirme a declaração de responsabilidade."}}),e.steps({headerTag:"h3",bodyTag:"fieldset",transitionEffect:"slideLeft",labels:{cancel:"Cancelar",current:"current step:",pagination:"Paginação",finish:"Finalizar",next:"Próximo",previous:"Anterior",loading:"Carregando ..."},onInit:function(e,a){},onStepChanging:function(a,o,r){return o>r||(o<r&&(e.find(".body:eq("+r+") label.error").remove(),e.find(".body:eq("+r+") .error").removeClass("error")),e.validate().settings.ignore=":disabled,:hidden",e.valid())},onStepChanged:function(a,o,r){2===o&&Number($("#age-2").val())>=18&&e.steps("next"),2===o&&3===r&&e.steps("previous")},onFinishing:function(a,o){return e.validate().settings.ignore=":disabled",e.valid()},onFinished:function(a,o){$.ajax({url:"/api/cadastros.php",type:"POST",dataType:"json",data:e.serialize()+"&a=cadastro",success:function(e){1==e.status&&(e.count>0?alert("Seu cadastro foi enviado para avaliação. Em breve entraremos em contato."):alert("."),location.href="/")}})}}).validate({errorPlacement:function(e,a){a.before(e)},rules:{confirm:{equalTo:"#password-2"}}}),$("#cadastros").fileapi({url:"/api/cadastros.php",data:{a:"foto"},accept:"image/*",imageSize:{minWidth:150,minHeight:200},elements:{active:{show:".js-upload",hide:".js-browse"},preview:{el:".js-preview",width:150,height:200},progress:".js-progress"},imageTransform:{maxWidth:354,maxHeight:472},onSelect:function(e,a){var o=a.files[0];FileAPI.support.transform?o&&($("#cad_fotografia").hide(),$("#popup").modal({closeOnEsc:!0,closeOnOverlayClick:!1,onOpen:function(e){$(e).on("click",".js-upload",function(){$.modal().close(),$("#cadastros").fileapi("upload")}),$(".js-img",e).cropper({file:o,bgColor:"#fff",maxSize:[$(window).width()-100,$(window).height()-100],minSize:[150,200],selection:"90%",aspectRatio:.75,onSelect:function(e){$("#cadastros").fileapi("crop",o,e)}})}}).open()):alert("Your browser does not support Flash :(")}}),$("input[name=cad_nascimento]").mask("00/00/0000"),$("input[name=cad_telefone1]").mask("(00)0000-00000"),$("input[name=cad_telefone2]").mask("(00)0000-00000"),$("input[name=cad_cpf]").mask("000.000.000-00"),$("input[name=cad_cep]").mask("00000-000"),$("input[name=cad_cpf]").blur(function(){$.ajax({type:"POST",cache:!1,url:"/api/cadastros.php",data:"a=cpf&cpf="+$(this).val(),dataType:"json",success:function(e){var a=e.cad_nascimento.split("-");a=a[2]+"/"+a[1]+"/"+a[0],$("#cad_fotografia").attr("src","/img/cadastros/"+e.cad_fotografia),$("input[name=cad_nome]").val(e.cad_nome),$("input[name=cad_pai]").val(e.cad_pai),$("input[name=cad_mae]").val(e.cad_mae),$("input[name=cad_nascimento]").val(e.cad_nascimento),$("input[name=cad_rg]").val(e.cad_rg),$("select[name=cad_estadocivil]").find("option[value="+e.cad_estadocivil+"]").attr("selected",!0),$("select[name=cad_escolaridade]").find("option[value="+e.cad_escolaridade+"]").attr("selected",!0),$("input[name=cad_profissao]").val(e.cad_profissao),$("input[name=cad_email]").val(e.cad_email),$("input[name=cad_email2]").val(e.cad_email),$("input[name=cad_telefone1]").val(e.cad_telefone1),$("input[name=cad_telefone2]").val(e.cad_telefone2),$("input[name=cad_cep]").val(e.cad_cep),$("select[name=cad_uf]").find("option[value="+e.cad_uf+"]").attr("selected",!0),$("input[name=cad_cidade]").val(e.cad_cidade),$("input[name=cad_bairro]").val(e.cad_bairro),$("input[name=cad_endereco]").val(e.cad_endereco),$("input[name=cad_numero]").val(e.cad_numero),$("input[name=cad_complemento]").val(e.cad_complemento),1==e.cad_newsletter?$("input[name=cad_newsletter]").attr("checked",!0):$("input[name=cad_newsletter]").attr("checked",!1)}})}),$("input[name=cad_cep]").blur(function(){$.ajax({type:"GET",cache:!1,url:"http://cep.republicavirtual.com.br/web_cep.php?formato=json",data:"cep="+$(this).val(),dataType:"json",success:function(e){$("input[name=cad_endereco]").val(e.tipo_logradouro+" "+e.logradouro),$("input[name=cad_cidade]").val(e.cidade),$("input[name=cad_bairro]").val(e.bairro),$("select[name=cad_uf]").find("option[value="+e.uf+"]").attr("selected",!0)}})})});